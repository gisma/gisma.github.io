<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />
<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Chris Reudenbach" />

<meta name="date" content="2016-03-10" />

<title>Projected data in mapview</title>

<script src="projView1_0_9_files/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="projView1_0_9_files/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="projView1_0_9_files/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="projView1_0_9_files/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="projView1_0_9_files/bootstrap-3.3.5/shim/respond.min.js"></script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; background-color: #f8f8f8; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
pre, code { background-color: #f8f8f8; }
code > span.kw { color: #204a87; font-weight: bold; }
code > span.dt { color: #204a87; }
code > span.dv { color: #0000cf; }
code > span.bn { color: #0000cf; }
code > span.fl { color: #0000cf; }
code > span.ch { color: #4e9a06; }
code > span.st { color: #4e9a06; }
code > span.co { color: #8f5902; font-style: italic; }
code > span.ot { color: #8f5902; }
code > span.al { color: #ef2929; }
code > span.fu { color: #000000; }
code > span.er { font-weight: bold; }
</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>



</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.tabbed-pane {
  padding-top: 12px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>


<div class="container-fluid main-container">

<!-- tabsets -->
<script src="projView1_0_9_files/navigation-1.0/tabsets.js"></script>
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->






<div class="fluid-row" id="header">


<h1 class="title">Projected data in mapview</h1>
<h4 class="author"><em>Chris Reudenbach</em></h4>
<h4 class="date"><em>March 10, 2016</em></h4>

</div>

<div id="TOC">
<ul>
<li><a href="#installation">Installation</a></li>
<li><a href="#some-remarks-about-projected-slippy-maps">Some remarks about projected slippy maps</a></li>
<li><a href="#use-case-epsg3031">Use case EPSG:3031</a></li>
<li><a href="#the-short-way">The short way</a></li>
<li><a href="#the-long-way">The long way</a><ul>
<li><a href="#slippy-maps-where-do-they-come-from">Slippy maps where do they come from?</a></li>
<li><a href="#hands-on-getting-the-information">Hands on getting the information</a><ul>
<li><a href="#identify-the-data-provider">Identify the data provider</a></li>
<li><a href="#check-which-data-is-available">Check which data is available</a></li>
<li><a href="#extract-the-necessary-informations">Extract the necessary informations</a></li>
<li><a href="#put-it-together">Put it together</a></li>
<li><a href="#assess-the-parameters">Assess the parameters</a></li>
</ul></li>
</ul></li>
<li><a href="#map.types-parameter-list-of-projview">map.types parameter list of projView</a><ul>
<li><a href="#things-you-better-know">Things you better know</a><ul>
<li><a href="#the-url-of-the-service">The URL of the service</a></li>
<li><a href="#the-remaining-parameters-of-the-urlservice">The remaining Parameters of the URL/Service</a></li>
<li><a href="#parameters-of-the-ruling-leaflet-map-object">Parameters of the ruling leaflet map object</a><ul>
<li><a href="#initialresolution">$initialResolution</a></li>
<li><a href="#bounds">$bounds</a></li>
<li><a href="#origin">$origin</a></li>
</ul></li>
</ul></li>
</ul></li>
<li><a href="#some-examples">Some examples</a></li>
<li><a href="#final-remarks">Final remarks</a></li>
</ul>
</div>

<p><img src="http://i.creativecommons.org/l/by-nc-sa/3.0/88x31.png" /> (CC-BY-NC-SA)</p>
<p>This document was produced on <em>So Mär 13 2016</em> using <code>mapview</code> version <strong>1.0.9</strong></p>
<hr />
<div id="installation" class="section level1">
<h1>Installation</h1>
<p>Currently you will find projView only in the development branch of mapview. If you want to use it the probably easiest way to install <code>mapview</code> is to use <code>library(&quot;devtools&quot;)</code>. With <code>devtools</code> installed and loaded type the following:</p>
<p>For the development version:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">install_github</span>(<span class="st">&quot;environmentalinformatics-marburg/mapview&quot;</span>, <span class="dt">ref =</span> <span class="st">&quot;develop&quot;</span>)</code></pre>
<hr />
</div>
<div id="some-remarks-about-projected-slippy-maps" class="section level1">
<h1>Some remarks about projected slippy maps</h1>
<p>Why would you be interested to visualize projected data? The answer is two folded but simple. First there are areas of the earth which you cannot map with a pseudo-Mercator projection and second (at least for me) even more important the adequate or inadequate cartographic representation of spatial data has a deep impact on our visual reception and interpretation of this data. The straightforward conclusion is that there is a high need for projected mapping.</p>
<p>Beyond all mapping philosophy let’s focus on a practical problem. We want to analyze and visualize some recent research data from the antartic continent using R and slippy maps. There is no possibility to use leaflet maps beyond the -85 degree latitude due to the implemented projections and we have to switch over to the great Open Source Geographic Information System <a href="http://www.qgis.org/" target="_blank">QGIS</a> or another mature GIS software package. With no doubt we may also use the well known static plotting packages of R - but no slippy maps for the penguins and polar bears within R.</p>
<p>Leaflet is a fascinating JavaScript library which is not only lightweight and easy to use. but moreover fully extensible with plug-ins and own JS scripts. With respect to our needs the proj4leaflet extension of leaflet is dealing with projections. The R interface to JS-leaflet is provided by the leaflet package and in turn the mapview package provides a comfortable wrapper for the R leaflet package. It seems to be obvious that this chaining may lead to some restrictions and exactly this is the situation.</p>
<p>ProjView uses its own interface directly to leaflet. To keep it in line with leaflet and mapview it is also using the htmlwidget package. the main advantage is that there is no need to live with the restrictions of the outlined chain but on the other hand you have to to it by your own means. Therefore projView is not neat less integrated and its usage and functionality is slightly different and restricted.</p>
</div>
<div id="use-case-epsg3031" class="section level1">
<h1>Use case EPSG:3031</h1>
<p>As we already have learned, the mapview penguin story ends at 85 degree of latitude. Using projView continuous the story. Unfortunately first we need to invest in the business - we have to gather some informations.</p>
</div>
<div id="the-short-way" class="section level1">
<h1>The short way</h1>
<p>You know what to do? Perfect. Search “NASA leaflet earthdata” and choose the appropriate <a href="https://wiki.earthdata.nasa.gov/display/GIBS/Map+Library+Usage" target="_blank">GIBS Map Library Usage</a> hit. Navigate to Leaflet and choose <a href="https://github.com/nasa-gibs/gibs-web-examples">GIS Web examples</a>. Find <a href="https://earthdata.nasa.gov/labs/gibs/examples/leaflet/antarctic-epsg3031.html">Antarctic (EPSG:3031)</a> and move down in this tutorial to <em>parameter format for use in preview</em>.</p>
</div>
<div id="the-long-way" class="section level1">
<h1>The long way</h1>
<div id="slippy-maps-where-do-they-come-from" class="section level2">
<h2>Slippy maps where do they come from?</h2>
<p>Basically for slippy maps you need on-line data from service providers. Best known are the WMS and OSM tiling services. All of some send you by request rasterized tiles of georeferenced maps, satellite images and so on. Usually you want to add your own vector or raster data overlay. Depending on the service and the client there are almost all possibilities out there. One of leaflets major pros is that it is easy and fast. The main reason is that it is a client side approach what means that your browser and your CPU has to do all the work because usually you are getting the data “as it is delivered”.</p>
<p>To learn how to prepare on-line services for mapview/leaflet we have to dive into the world of web mapping services.You will find a brief and simple explanation of how web maps (web services for web maps) works at Mapbox in the article (<a href="https://www.mapbox.com/help/how-web-maps-work/" target="_blank"> How web maps works </a>). Unfortunately you have to forget the last conclusion.</p>
<p>Basically we need to access from a high level client (mapview) data tiles to retrieve. So we have to to know (1) which products are available (2) which map projections are available (3) how many zoom levels per product are available and (4) which protocol to access the data is available.</p>
<p>Due to the fact that without a service provider you hardly will find a service and data, it is obviously rational that you first take a look at this topic. For an introduction of the WMS related services you will find a perfect outline of what OGC services are around and what they mean in the <a href="http://docs.qgis.org/2.6/en/docs/user_manual/working_with_ogc/ogc_client_support.html">QGIS OGC Documentation</a>. Please note even if this documentations refers to GIS as a client all decribed concepts of the services are valid for all type of clients. For the OSM tiling concept you may have a look at the OSM Wiki topic called <a href="http://wiki.openstreetmap.org/wiki/Tiles">Tiles</a>. Both concepts differ pretty much even if you will get as a result - tiles.</p>
<p>In theory, everything seems to be clear so far.</p>
</div>
<div id="hands-on-getting-the-information" class="section level2">
<h2>Hands on getting the information</h2>
<p>We have learned that it makes sense to start at a data provider and to find out what standards products on which projection and zoomlevel they provide.</p>
<p>ProjView supports up to now WMTS related services.</p>
<ol style="list-style-type: decimal">
<li>Identify the data provider</li>
<li>Check which data is available for WMTS</li>
<li>Extract the necessary informations.</li>
</ol>
<div id="identify-the-data-provider" class="section level3">
<h3>Identify the data provider</h3>
<p>A big shot and always a good first try in data retrieval processing and providing in the earth science scene is the NASA Earth Observing System Data and Information System <a href="https://earthdata.nasa.gov/about" target="_blank">EOSDIS</a>. Don’t get confused. They provide an incredible amount of information and data but you have to know how to find it. It is a typical govermental structure. EOSDIS implements the Earth Science Data and Information System <a href="https://earthdata.nasa.gov/about/esdis-project" target="_blank"> ESDIS </a> for data providing. Within this EarthData portal you will find all types of interfaces and services. Best way to get <i>real</i> information is the usage of the <a href="https://wiki.earthdata.nasa.gov/display/ECE/Dashboard" target="_blank">EarthData-Wiki</a>.</p>
<p>As we are interested in web served data we need providers of this data. Just to have an example we will have a look at the NASA Global Imagery Browse Services <a href="https://wiki.earthdata.nasa.gov/display/GIBS" target="_blank">GIBS</a>. Here you will find all kinds of data and informations you may interested in. The services implement functionality for automated anaysis of the provided Content. We will use the most common OGC Web Map Tile Service (WMTS). The EarthData-Wiki provides all information at <a href="https://wiki.earthdata.nasa.gov/display/GIBS/GIBS+API+for+Developers#GIBSAPIforDevelopers-OGCWebMapTileService(WMTS)" target="_blank">GIBS API for Developers</a> OGC Web Map Tile Service (WMTS).</p>
</div>
<div id="check-which-data-is-available" class="section level3">
<h3>Check which data is available</h3>
<p>As we are interested in the antarctic region we look for something like <em>Antarctic polar stereographic - EPSG:3031</em> . We choose the <a href="http://map1.vis.earthdata.nasa.gov/wmts-antarctic/1.0.0/WMTSCapabilities.xml">REST GetCapabilities</a> link and get an incredible XML output.</p>
</div>
<div id="extract-the-necessary-informations" class="section level3">
<h3>Extract the necessary informations</h3>
<p>You can read it now manually or write a script to extract the information you need.</p>
</div>
<div id="put-it-together" class="section level3">
<h3>Put it together</h3>
<p>projView is using the proj4leaflet <a href="http://kartena.github.io/Proj4Leaflet/api/">api</a>. For a basic setup of tiles we need at least the following arguments.</p>
<ul>
<li>service and service parameters</li>
<li>internal service parameters usually url, format, tilesize, subdomains…</li>
<li>leaflet map parameters, as correct bounding and upper left corner coordinates zoom levels, resolution …</li>
<li>target projection (EPSG Code and proj4 string)</li>
</ul>
</div>
<div id="assess-the-parameters" class="section level3">
<h3>Assess the parameters</h3>
<p>Let’s assume we are interested in the Blue Marble Shaded Relief Bathymetry. If we search for this layer in the <a href="http://map1.vis.earthdata.nasa.gov/wmts-antarctic/1.0.0/WMTSCapabilities.xml">REST GetCapabilities</a> XML file we will see something like:</p>
<pre class="sourceCode xml"><code class="sourceCode xml"><span class="kw">&lt;Layer&gt;</span>
<span class="kw">&lt;ows:Title&gt;</span>BlueMarble_ShadedRelief_Bathymetry<span class="kw">&lt;/ows:Title&gt;</span>
<span class="kw">&lt;ows:LowerCorner&gt;</span>-180 -90<span class="kw">&lt;/ows:LowerCorner&gt;</span>
<span class="kw">&lt;ows:UpperCorner&gt;</span>180 -38.941373<span class="kw">&lt;/ows:UpperCorner&gt;</span>
<span class="kw">&lt;/ows:WGS84BoundingBox&gt;</span>
<span class="kw">&lt;ows:BoundingBox</span><span class="ot"> crs=</span><span class="st">&quot;urn:ogc:def:crs:EPSG::3031&quot;</span><span class="kw">&gt;</span>
<span class="kw">&lt;ows:LowerCorner&gt;</span>-4194304 -4194304<span class="kw">&lt;/ows:LowerCorner&gt;</span>
<span class="kw">&lt;ows:UpperCorner&gt;</span>4194304 4194304<span class="kw">&lt;/ows:UpperCorner&gt;</span>
<span class="kw">&lt;/ows:BoundingBox&gt;</span>
<span class="kw">&lt;ows:Identifier&gt;</span>BlueMarble_ShadedRelief_Bathymetry<span class="kw">&lt;/ows:Identifier&gt;</span>
<span class="kw">&lt;Style</span><span class="ot"> isDefault=</span><span class="st">&quot;true&quot;</span><span class="kw">&gt;</span>
<span class="kw">&lt;ows:Title&gt;</span>default<span class="kw">&lt;/ows:Title&gt;</span>
<span class="kw">&lt;ows:Identifier&gt;</span>default<span class="kw">&lt;/ows:Identifier&gt;</span>
<span class="kw">&lt;/Style&gt;</span>
<span class="kw">&lt;Format&gt;</span>image/jpeg<span class="kw">&lt;/Format&gt;</span>
<span class="kw">&lt;TileMatrixSetLink&gt;</span>
<span class="kw">&lt;TileMatrixSet&gt;</span>EPSG3031_500m<span class="kw">&lt;/TileMatrixSet&gt;</span>
<span class="kw">&lt;/TileMatrixSetLink&gt;</span>
<span class="kw">&lt;ResourceURL</span><span class="ot"> format=</span><span class="st">&quot;image/jpeg&quot;</span><span class="ot"> resourceType=</span><span class="st">&quot;tile&quot;</span><span class="ot"> template=</span><span class="st">&quot;http://map1.vis.earthdata.nasa.gov/wmts-antarctic/BlueMarble_ShadedRelief_Bathymetry/default/{TileMatrixSet}/{TileMatrix}/{TileRow}/{TileCol}.jpg&quot;</span><span class="kw">/&gt;</span>
<span class="er">&lt;</span>/Layer&gt;</code></pre>
<p>Admittedly annoying to read but it provides all necessary information in a compact way.</p>
<p>First we have to analyze the primary arguments:</p>
<ul>
<li>ResourceURL</li>
<li>format</li>
<li>resourceType</li>
<li>template</li>
<li>BoundingBox</li>
<li>LowerCorner</li>
<li>UpperCorner</li>
<li>Identifier</li>
</ul>
<p>If we focus <em>ResourceURL</em> we will find more information in the the argument <em>template</em>:</p>
<p><em><a href="http://map1.vis.earthdata.nasa.gov/wmts-antarctic/BlueMarble_ShadedRelief_Bathymetry/default/{TileMatrixSet}/{TileMatrix}/{TileRow}/{TileCol}.jpg" class="uri">http://map1.vis.earthdata.nasa.gov/wmts-antarctic/BlueMarble_ShadedRelief_Bathymetry/default/{TileMatrixSet}/{TileMatrix}/{TileRow}/{TileCol}.jpg</a></em></p>
<p>To construct a valid URL we also need the content of the following variables: * {TileMatrixSet} * {TileMatrix},{TileRow},{TileCol}</p>
<p>There are still some parameters missing which are not documented in the xml file. We will find tileSize and zoomlevel information at the <a href="https://wiki.earthdata.nasa.gov/display/GIBS/GIBS+API+for+Developers#GIBSAPIforDevelopers-AntarcticPolarStereographic(EPSG:3031)">EPSG:3031 examples</a> table. Additionally it is common that the variable {TileMatrix},{TileRow},{TileCol} are corresponding to the subdomains of the WMTS Rest format (i.e. “abc”).</p>
<p>Ready to compile the information.</p>
</div>
</div>
</div>
<div id="map.types-parameter-list-of-projview" class="section level1">
<h1>map.types parameter list of projView</h1>
<p>Now we need an appropriate structure for these parameters to make it less complicated to feed the projView function with this information. This is a simple nested list. If we fill it with the values it looks like this:</p>
<pre class="sourceCode r"><code class="sourceCode r">NASA=<span class="kw">list</span>(<span class="dt">service=</span><span class="st">&quot;OSM&quot;</span>,                                             <span class="co"># name of the list</span>
<span class="dt">L.tileLayer=</span><span class="st">&quot;https://map1{s}.vis.earthdata.nasa.gov/wmts-antarctic/&quot;</span>, <span class="co"># base address &lt;ResourceURL&gt;</span>
<span class="co"># layer list is structured like the path of the url in this case: &lt;ows:Identifier&gt;,&lt;TileMatrixSet&gt;</span>
          <span class="dt">layer=</span><span class="kw">list</span>( <span class="st">&quot;BlueMarble_ShadedRelief_Bathymetry&quot;</span>   =<span class="st"> </span><span class="kw">list</span>(<span class="st">&quot;BlueMarble_ShadedRelief_Bathymetry&quot;</span>,<span class="st">&quot;default&quot;</span>,<span class="st">&quot;EPSG3031_500m&quot;</span>,<span class="st">&quot;{z}/{y}/{x}&quot;</span>),
                      <span class="st">&quot;AMSR2_Sea_Ice_Brightness_Temp_6km_89H&quot;</span>=<span class="st"> </span><span class="kw">list</span>(<span class="st">&quot;AMSR2_Sea_Ice_Brightness_Temp_6km_89H&quot;</span>,<span class="st">&quot;default&quot;</span>,<span class="st">&quot;2014-02-04&quot;</span>,<span class="st">&quot;EPSG3031_1km&quot;</span>,<span class="st">&quot;{z}/{y}/{x}&quot;</span>),
                      <span class="st">&quot;MODIS_Terra_Snow_Cover&quot;</span>               =<span class="st"> </span><span class="kw">list</span>(<span class="st">&quot;MODIS_Terra_Snow_Cover&quot;</span>,<span class="st">&quot;default&quot;</span>,<span class="st">&quot;2014-02-04&quot;</span>,<span class="st">&quot;EPSG3031_1km&quot;</span>,<span class="st">&quot;{z}/{y}/{x}&quot;</span>)
          ),      <span class="co"># end of layer list</span>
 
<span class="dt">format=</span><span class="st">&quot;image/jpg&quot;</span>,<span class="co">#&lt;Format&gt;</span>
<span class="dt">tileSize=</span><span class="st">&quot;512&quot;</span>,   <span class="co"># min resolution  EPSG:3031 examples</span>
<span class="dt">subdomains=</span><span class="st">&quot;abc&quot;</span>, <span class="co"># most often used -&gt; can be assumed as default </span>
<span class="dt">noWrap =</span><span class="st">&quot;true&quot;</span>,   <span class="co"># most often used -&gt; can be assumed as default </span>
<span class="co"># attribution has to meet the data providers needs and your personal interpretation of transparence </span>
<span class="dt">attribution=</span><span class="st">&quot;&lt;a href=&#39;https://wiki.earthdata.nasa.gov/display/GIBS&#39;&gt; NASA EOSDIS GIBS&lt;/a&gt; &amp;nbsp;|| &amp;nbsp; &lt;a href=&#39;https://github.com/kartena/Proj4Leaflet&#39;&gt; Proj4Leaflet&lt;/a&gt; | Projection: &lt;a href=&#39;http://spatialreference.org/ref/epsg/wgs-84-antarctic-polar-stereographic/&#39;&gt; EPSG3031&lt;/a&gt;&quot;</span>,
<span class="dt">params=</span><span class="kw">list</span>(<span class="dt">t_epsg=</span><span class="st">&quot;EPSG:3031&quot;</span>, <span class="co"># exactly this the EPSG Code beside all other possibilieties and standards if possible keep it like this</span>
<span class="dt">t_srs=</span><span class="st">&quot;+proj=stere +lat_0=-90 +lat_ts=-71 +lon_0=0 +k=1 +x_0=0 +y_0=0 +datum=WGS84 +units=m +no_defs&quot;</span>, <span class="co"># corresponding proj4 strings best be taken from href=&#39;http://spatialreference.org</span>
<span class="dt">mapCenter=</span><span class="kw">list</span>(<span class="dt">cLat=</span><span class="st">&quot;-90&quot;</span>,  <span class="co">#see example map EPSG:3031 examples</span>
<span class="dt">cLon=</span><span class="st">&quot;0&quot;</span>),                  <span class="co">#see example map EPSG:3031 examples</span>
<span class="dt">initialZoom=</span><span class="st">&quot;1&quot;</span>,            <span class="co">#EPSG:3031 examples: Please note that the &quot;top tile&quot; (i.e., zoom level 0) is not currently supported by GIBS.</span>
<span class="dt">zoomLevels=</span><span class="st">&quot;5&quot;</span>,             <span class="co"># zoom/levels EPSG:3031 examples</span>
<span class="dt">initialResolution=</span><span class="st">&quot;256&quot;</span>,           <span class="co"># = minresolution EPSG:3031 examples</span>
<span class="dt">ovlBounds=</span><span class="kw">list</span>(<span class="dt">minx=</span><span class="st">&quot;-4194304&quot;</span>, ## &lt;ows:LowerCorner&gt;
<span class="dt">miny=</span><span class="st">&quot;-4194304&quot;</span>,                ## &lt;ows:LowerCorner&gt;
<span class="dt">maxx=</span><span class="st">&quot;4194304&quot;</span>,                 ## &lt;ows:UpperCorner&gt;
<span class="dt">maxy=</span><span class="st">&quot;4194304&quot;</span>),                ## &lt;ows:UpperCorner&gt;
<span class="dt">origin=</span><span class="kw">list</span>(<span class="dt">olx=</span><span class="st">&quot;-4194304&quot;</span>,    ## &lt;ows:LowerCorner&gt; firstvalue minx
<span class="dt">oly=</span><span class="st">&quot;4194304&quot;</span>),                ## &lt;ows:UpperCorner&gt; lastvalue maxy
<span class="dt">relUrl=</span><span class="st">&quot;&quot;</span>                      ## obsolete used for local tiles
))</code></pre>
<div id="things-you-better-know" class="section level2">
<h2>Things you better know</h2>
<p>You may imagine that serving of tiles is a world itself. Therefore it seems to be pretty ambitious to find a all in one solution. What I tried so far is to get a as simple as possible way to use WMS and OSM services. You should know some internal calculations and undocumented argument usage to prevent that you are going mad watching the weird behaviour of the tool.</p>
<p>First a dump of the list to identfy the crucial arguments we have to talk about.</p>
<pre><code>List of 11
 $ service    : chr &quot;OSM&quot;
 $ L.tileLayer: chr &quot;https://map1{s}.vis.earthdata.nasa.gov/wmts-antarctic/&quot;
 $ layer      :List of 3
  ..$ BlueMarble_ShadedRelief_Bathymetry   :List of 4
  .. ..$ : chr &quot;BlueMarble_ShadedRelief_Bathymetry&quot;
  .. ..$ : chr &quot;default&quot;
  .. ..$ : chr &quot;EPSG3031_500m&quot;
  .. ..$ : chr &quot;{z}/{y}/{x}&quot;
  ..$ AMSR2_Sea_Ice_Brightness_Temp_6km_89H:List of 5
  .. ..$ : chr &quot;AMSR2_Sea_Ice_Brightness_Temp_6km_89H&quot;
  .. ..$ : chr &quot;default&quot;
  .. ..$ : chr &quot;2014-02-04&quot;
  .. ..$ : chr &quot;EPSG3031_1km&quot;
  .. ..$ : chr &quot;{z}/{y}/{x}&quot;
  ..$ MODIS_Terra_Snow_Cover               :List of 5
  .. ..$ : chr &quot;MODIS_Terra_Snow_Cover&quot;
  .. ..$ : chr &quot;default&quot;
  .. ..$ : chr &quot;2014-02-04&quot;
  .. ..$ : chr &quot;EPSG3031_1km&quot;
  .. ..$ : chr &quot;{z}/{y}/{x}&quot;
 $ format     : chr &quot;image/jpg&quot;
 $ tileSize   : chr &quot;512&quot;
 $ subdomains : chr &quot;abc&quot;
 $ minZoom    : num 0
 $ maxZoom    : num 5
 $ noWrap     : chr &quot;true&quot;
 $ attribution: chr &quot;&lt;a href=&#39;https://wiki.ear __truncated__&#39;&quot;
 $ params     :List of 9
  ..$ t_epsg           : chr &quot;EPSG:3031&quot;
  ..$ t_srs            : chr &quot;+proj=stere +lat_0=-90 +lat_ts=-71 +lon_0=0 +k=1 +x_0=0 +y_0=0 +datum=WGS84 +units=m +no_defs&quot;
  ..$ mapCenter        :List of 2
  .. ..$ cLat: chr &quot;-90&quot;
  .. ..$ cLon: chr &quot;0&quot;
  ..$ initialZoom      : chr &quot;0&quot;
  ..$ zoomLevels       : chr &quot;5&quot;
  ..$ initialResolution: chr &quot;256&quot;
  ..$ ovlBounds        :List of 4
  .. ..$ minx: chr &quot;-4194304&quot;
  .. ..$ miny: chr &quot;-4194304&quot;
  .. ..$ maxx: chr &quot;4194304&quot;
  .. ..$ maxy: chr &quot;4194304&quot;
  ..$ origin           :List of 2
  .. ..$ olx: chr &quot;-4194304&quot;
  .. ..$ oly: chr &quot;4194304&quot;
  ..$ relUrl           : chr &quot;&quot;</code></pre>
<div id="the-url-of-the-service" class="section level3">
<h3>The URL of the service</h3>
<p>The whole List will be iterated using the sublist <em><span class="math">\(layer* to build the URL, in the example case 3 times. The root of the url is always *\)</span>L.tileLayer</em>:</p>
<p>Note the first item will be <strong>always</strong> the baselayer of the map and can not be switched on an off.</p>
<p>Each layer item is then iterated over the path list. Note the items <strong>must</strong> be in the sequence of the path because they were pasted in exactly one after the other.</p>
<p>As a result you should get the (correct) URL for the service.</p>
</div>
<div id="the-remaining-parameters-of-the-urlservice" class="section level3">
<h3>The remaining Parameters of the URL/Service</h3>
<p>All items except <em><span class="math">\(params* and *\)</span>layer</em> are parsed and used to set up a correct <em>L.tileLayer{}</em> parameter list. They can be crucial and it is possible that you have to play around a bit</p>
</div>
<div id="parameters-of-the-ruling-leaflet-map-object" class="section level3">
<h3>Parameters of the ruling leaflet map object</h3>
<p>All Parameters of the <em>$param</em> list belong to the leaflet map object respective the Proj4Leaflet extension for non leaflet CRSs.</p>
<p>Most of them are as they are looking like. Especially <em><span class="math">\(initialResolution*, *\)</span>ovlBound</em> and <em>$origin</em>. These parameter set is ruling the leaflet map object setup and even if everything all other arguments are perfect, you will get strange or no effects, if they don’t meet the needs of the data providers.</p>
<div id="initialresolution" class="section level4">
<h4>$initialResolution</h4>
<p>Usually it is tried to calculate the resolution automatically. the approach is simple:</p>
<pre><code>        maxResolution &lt;- res / div
        resolution&lt;- list()
        for ( i in seq(0,maxZoom)){
        resolution[i+1] &lt;- maxResolution /  2^i
        }</code></pre>
<p>where i is the increasing level of zoom up to maxZoom, res is the maximum extend of the the bounds of the maps, div is the tilSize scaled by the initialResolution. Ususally tileSize and initialResoulution should be the same than div=tileSize if not div&lt;-tileSize/initialRes*tileSize</p>
<p>If you are not able to find a good range of resolution but you find an example then you may just paste it in initialResolution.</p>
<pre><code>       initialResolution=c(8192,4096,2048, 1024, 512, 256, 128,64, 32, 16, 8, 4, 2,1,0.5,0.25,0.125,0.0625)</code></pre>
<p>This will be taken as it is.</p>
</div>
<div id="bounds" class="section level4">
<h4>$bounds</h4>
<p>If you don’t need or have no idea about the bounds you may try to set at least one of the values to NULL</p>
<pre><code>    minx=NULL
    </code></pre>
<p>with this option no bounds will be generated.</p>
</div>
<div id="origin" class="section level4">
<h4>$origin</h4>
<p>the origin has always to be set. Note you <strong>must</strong> use values of the target reference system. Especially in polar stereographic projections that are not centered on the pole this can be tricky.</p>
<p>Time for some examples…</p>
</div>
</div>
</div>
</div>
<div id="some-examples" class="section level1">
<h1>Some examples</h1>
<p>To avoid some strange side effects you’ll find the examples on seperates pages:</p>
<ul>
<li><a href="/projView1_0_9_AC.html/">Arctic Connect</a> <a href="projView1_0_9_AC.html" target="_blank"> Arctic Connect Mapserver </a> ——</li>
</ul>
</div>
<div id="final-remarks" class="section level1">
<h1>Final remarks</h1>
<p>There are still more limitations than solutions. Actually the process of generating the correct map.types lists is more ore less cumbersome. On the other hand in the end there is always some manual work due to non strict service declarations. If somebody likes the function it could be worthwhile to automated this process.</p>
<p>In future releases I would like to</p>
<ul>
<li>provide some additional functions for often used datasets</li>
<li>integrate a fully working localTile functionality for serving local raster data</li>
<li>…</li>
</ul>
<p>If you have any feedback, please don’t hesitate to contact <a href="http://www.uni-marburg.de/fb19/personal/mitarbeiter/reudenbachc/index.html">me</a>.</p>
<p>Bug reports should be filed at <a href="https://github.com/environmentalinformatics-marburg/mapview/issues" target="_blank">https://github.com/environmentalinformatics-marburg/mapview/issues</a></p>
<p>Cheers</p>
<p>Chris</p>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
$(document).ready(function () {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
});

</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
